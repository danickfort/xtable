<% if !user_signed_in? then %>
<div class="jumbotron">
	<h1>Welcome to xTable</h1>
	<p>
		This app aims to make your life easier!<br />It's a smart calendar that helps you to <strong>manage</strong> and <strong>optimize</strong> your time. You can publish and subscribe to group events. xTable handles <strong>conflicts</strong> in your calendar, meaning that it warns you if you planned to go to many events at the same time!
	</p>
	<p>
		<%= link_to  "It's time to get in!", new_user_session_path(), class: "btn btn-primary btn-lg"%>
	</p>
</div>
<% else %>
<% if @conflictingEvents.empty? %>
<div id="calendar"></div>
<% else %>
<div id="calendar" class="col-md-7"></div>
<div id="conflicts" class="col-md-5">
	<h2 class="bg-warning">You have conflicts!</h2>
     <% @conflictingEvents.each do |e| %>
	<table class="table table-hover">
  <thead>
    <tr>
      <th>Name</th>
      <th style="text-align: right">Group</th>
    </tr>
  </thead>
  <tbody>
       <% e.each do |o| %>
       <tr>
       	<td>
         <%= link_to o.name, event_path(o) %>
         </td>
         <td style="text-align:right">
         	<% if current_user.private_group != o.group %>
         	<%= o.group.name %>
         	<% else %>
         	Your own event
         	<% end %>
         </td>
        </tr>
         <% end %>
       </tbody>
       </table>
       <% end %>
       <% end %>
</div>
<script>
	$(document).ready(function() { 
		var calendarWrapper = new zCalendarWrapper({
			container: '#calendar',
			api: {
				get: "<%= events_path %>.json",
				add: "<%= events_path %>.json",
				erase: "<%= events_path %>"
			},
			group_id: <%= current_user.private_group.id %>,
			isAdmin: true
		});
	}) ;
</script>
<% end %>
